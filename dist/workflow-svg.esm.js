export default function WorkflowSVG(){function a(a,b){var c=a.group().attr({id:b.id});a.entities.push(c),b.background_color=b.background_color?b.background_color:"#f06",b.color=b.color?b.color:"#ffffff",b.radius=b.radius?b.radius:0,c.dragPoints=[],c.entity=c.rect(b.width,b.height).cx(b.width/2).cy(b.height/2).attr({fill:b.background_color}).radius(b.radius),c.entity.type=b.type,"operation"===b.type&&c.entity.transform({rotate:45,origin:"center center"}),b["class"]&&c.entity.attr("class",b["class"]);var e=c.plain(b.text).cx(b.width/2).cy(b.height/2).attr({fill:b.color});if(b.fa_unicode&&0<b.fa_unicode.length){e.dx(10),c.icon=c.plain().cy(b.height/2).x(0<b.text.length?e.x()-20:b.height/2-10).attr({fill:b.color}),4==u.configuration.font_awesome&&c.icon.font({family:"font_awesome"}),5==u.configuration.font_awesome&&c.icon.font({family:"\"Font Awesome 5 Free\""});var g=b.fa_unicode.startsWith("&#x")?b.fa_unicode:"&#x"+b.fa_unicode+";";c.icon.node.innerHTML=g}c.arrows=c.group();var h=c.rect(b.width+50,b.height+50).cx(b.width/2).cy(b.height/2).attr({opacity:"0",fill:"#FFBF00"});"operation"===b.type&&h.transform({rotate:45}),c.dragGroup=c.group();//dragabble area
var i=c.rect(b.width-20,b.height-20).cx(b.width/2).cy(b.height/2).attr({opacity:0});u.configuration.read_only||(i.draggable().on("dragmove.namespace",function(d){d.preventDefault();var e=d.detail.box;//to update json
a.grid.x.forEach(function(a){var b=e.cx-a.value;10>b&&-10<b?(e.cx=a.value,a.line.show()):"static"!=u.configuration.grid_type&&a.line.hide()}),a.grid.y.forEach(function(a){var b=e.cy-a.value;10>b&&-10<b?(e.cy=a.value,a.line.show()):"static"!=u.configuration.grid_type&&a.line.hide()}),c.cx(e.cx),c.cy(e.cy),b.x=c.x()+25,b.y=c.y()+25,f(a,w)}).attr({cursor:"move"}).on("dragstart",function(){v.forEach(function(a){return a.remove()}),v=[]}).on("dragend",function(b){"static"!=u.configuration.grid_type&&(a.grid.y.forEach(function(a){return a.line.hide()}),a.grid.x.forEach(function(a){return a.line.hide()})),p("entity:moved",q(b))}).on("click",function(a){p("entity:clicked",q(a))}),h.on("mouseover",function(b){d(a,c,"top"),d(a,c,"right"),d(a,c,"bottom"),d(a,c,"left"),b.stopPropagation()}),a.on("mouseover",function(){c.dragPoints.forEach(function(a){v.includes(a)||a.remove()})})),c.move(b.x-25,b.y-25)}function b(){u.configuration.grid_x&&0<u.configuration.grid_x.length&&(u.configuration.grid_x.forEach(function(a){t.grid.x.push({value:a.value,line:t.gridGroup.polyline([[a.value,0],[a.value,t.height()]]).fill("none").stroke({color:a.color?a.color:"black",width:a.width?a.width:1,linecap:"round",linejoin:"round"})})}),"static"!=u.configuration.grid_type&&t.grid.x.forEach(function(a){return a.line.hide()})),u.configuration.grid_y&&0<u.configuration.grid_y.length&&(u.configuration.grid_y.forEach(function(a){t.grid.y.push({value:a.value,line:t.gridGroup.polyline([[0,a.value],[t.width(),a.value]]).fill("none").stroke({color:a.color?a.color:"black",width:a.width?a.width:1,linecap:"round",linejoin:"round"})})}),"static"!=u.configuration.grid_type&&t.grid.y.forEach(function(a){return a.line.hide()}))}function c(){u.labels&&0<u.labels.length&&u.labels.forEach(function(a){var b=t.labels.text(a.value).x(a.x).y(a.y);!0!=u.configuration.read_only&&b.attr({cursor:"move",fill:a.color}).draggable().on("dragend",function(b){var c=b.detail.box;a.x=c.x,a.y=c.y,p("label:moved",q(b))})})}function d(a,b,c){var d=k(b,c),e=l(b,c);b.dragPoints.push(b.dragGroup.circle(10,10).attr({fill:"white",stroke:"#d4d4d4",id:c}).move(d-5,e-5).on("mouseover",function(a){// make point bigger
this.transform({scale:2}),a.stopPropagation()}).on("click",function(){if(!!v.includes(this))v=[];else if(v.push(this),2==v.length){var b={id:"line-"+w.length,from:{element:v[0].parent().parent().attr("id"),point:v[0].attr("id")},to:{element:v[1].parent().parent().attr("id"),point:v[1].attr("id")}};w.push(b),u.lines.push(n(b)),f(a,w),v=[],p("line:added",b)}}).on("mouseout",function(a){v.includes(this)||this.transform({scale:1}),a.stopPropagation()}))}function f(a,b){b.forEach(function(b){return g(a,b)})}function g(a,b){var c="",d=u.configuration.line_color,e=a.findOne("#"+b.from.element),f=a.findOne("#"+b.to.element),g=i(b,e,f);c+=k(e,b.from.point)+","+l(e,b.from.point)+" ",g.forEach(function(a){return c+=a.x+","+a.y+" "}),c+="top"===b.to.point?k(f,b.to.point)+","+(l(f,b.to.point)-5)+" ":"right"===b.to.point?k(f,b.to.point)+5+","+l(f,b.to.point)+" ":"bottom"===b.to.point?k(f,b.to.point)+","+(l(f,b.to.point)+5)+" ":k(f,b.to.point)-5+","+l(f,b.to.point)+" ";b.polyline?b.polyline.plot(c):b.polyline=a.lines.polyline(c).fill("none").stroke({color:d,width:4,linecap:"round",linejoin:"round"}).on("click",function(a){p("line:clicked",a.target.id)}).attr("id",b.id);h(b,f,d)}function h(a,b,c){if(!a.to.arrow&&"default"===u.configuration.arrow_type){var d=k(b,a.to.point)+","+l(b,a.to.point)+" ";"top"===a.to.point?(d+=k(b,a.to.point)+7+","+(l(b,a.to.point)-14)+" ",d+=k(b,a.to.point)-7+","+(l(b,a.to.point)-14)+" "):"right"===a.to.point?(d+=k(b,a.to.point)+14+","+(l(b,a.to.point)-7)+" ",d+=k(b,a.to.point)+14+","+(l(b,a.to.point)+7)+" "):"bottom"===a.to.point?(d+=k(b,a.to.point)+7+","+(l(b,a.to.point)+14)+" ",d+=k(b,a.to.point)-7+","+(l(b,a.to.point)+14)+" "):(d+=k(b,a.to.point)-14+","+(l(b,a.to.point)-7)+" ",d+=k(b,a.to.point)-14+","+(l(b,a.to.point)+7)+" "),a.to.arrow=b.arrows.polygon(d).fill(c).stroke({width:1})}}function i(a,b,c){var d=[],e=l(b,a.from.point),f=l(c,a.to.point),g=k(b,a.from.point),h=k(c,a.to.point),i=j(a.from.point),m=j(a.to.point),n=i-m;return 0===n&&("top"===a.from.point?e<=f?(d.push({x:g,y:e-20}),d.push({x:h,y:e-20})):(d.push({x:g,y:f-20}),d.push({x:h,y:f-20})):"bottom"===a.from.point?e<=f?(d.push({x:g,y:f+20}),d.push({x:h,y:f+20})):(d.push({x:g,y:e+20}),d.push({x:h,y:e+20})):"left"===a.from.point?g<=h?(d.push({x:g-20,y:e}),d.push({x:g-20,y:f})):(d.push({x:h-20,y:e}),d.push({x:h-20,y:f})):g<=h?(d.push({x:h+20,y:e}),d.push({x:h+20,y:f})):(d.push({x:g+20,y:e}),d.push({x:g+20,y:f}))),(2===n||-2===n)&&("left"===a.from.point||"right"===a.from.point?e!==f&&(d.push({x:g+(h-g)/2,y:e}),d.push({x:g+(h-g)/2,y:f})):g!==h&&(d.push({x:g,y:f+(e-f)/2}),d.push({x:h,y:f+(e-f)/2}))),(1===n||-1===n||3===n||-3===n)&&("top"===a.from.point&&("left"===a.to.point?e<f+20?(d.push({x:g,y:e-20}),d.push({x:h-20,y:e-20}),d.push({x:h-20,y:f})):g>h-20?(d.push({x:g,y:e-20}),d.push({x:h-20,y:e-20}),d.push({x:h-20,y:f})):d.push({x:g,y:f}):"right"===a.to.point?e<f+20?(d.push({x:g,y:e-20}),d.push({x:h+20,y:e-20}),d.push({x:h+20,y:f})):h>g-20?(d.push({x:g,y:e-20}),d.push({x:h+20,y:e-20}),d.push({x:h+20,y:f})):d.push({x:g,y:f}):e<f+20?(d.push({x:g,y:e-20}),d.push({x:h+20,y:e-20}),d.push({x:h+20,y:f})):d.push({x:g,y:f})),"bottom"===a.from.point&&("left"===a.to.point?e>f-20?(d.push({x:g,y:e+20}),d.push({x:h-20,y:e+20}),d.push({x:h-20,y:f})):g>h-20?(d.push({x:g,y:e+20}),d.push({x:h-20,y:e+20}),d.push({x:h-20,y:f})):d.push({x:g,y:f}):"right"===a.to.point?e>f-20?(d.push({x:g,y:e+20}),d.push({x:h-20,y:e+20}),d.push({x:h-20,y:f})):h>g-20?(d.push({x:g,y:e+20}),d.push({x:h+20,y:e+20}),d.push({x:h+20,y:f})):d.push({x:g,y:f}):e>f-20?(d.push({x:g,y:e+20}),d.push({x:h+20,y:e+20}),d.push({x:h+20,y:f})):d.push({x:g,y:f})),"left"===a.from.point&&("top"===a.to.point?e>f-20?(d.push({x:g-20,y:e}),d.push({x:g-20,y:f-20}),d.push({x:h,y:f-20})):h>g-20?(d.push({x:g-20,y:e}),d.push({x:g-20,y:f-20}),d.push({x:h,y:f-20})):d.push({x:h,y:e}):"bottom"===a.to.point?e>f+20?h>g-20?(d.push({x:g-20,y:e}),d.push({x:g-20,y:f+20}),d.push({x:h,y:f+20})):d.push({x:h,y:e}):(d.push({x:g-20,y:e}),d.push({x:g-20,y:f+20}),d.push({x:h,y:f+20})):e>f-20?d.push({x:h,y:e}):(d.push({x:g-20,y:e}),d.push({x:g-20,y:f+20}),d.push({x:h,y:f+20}))),"right"===a.from.point&&("top"===a.to.point?e>f-20?(d.push({x:g+20,y:e}),d.push({x:g+20,y:f-20}),d.push({x:h,y:f-20})):g>h-20?(d.push({x:g+20,y:e}),d.push({x:g+20,y:f-20}),d.push({x:h,y:f-20})):d.push({x:h,y:e}):"bottom"===a.to.point?e>f+20?g>h-20?(d.push({x:g+20,y:e}),d.push({x:g+20,y:f+20}),d.push({x:h,y:f+20})):d.push({x:h,y:e}):(d.push({x:g+20,y:e}),d.push({x:g+20,y:f+20}),d.push({x:h,y:f+20})):e>f-20?d.push({x:h,y:e}):(d.push({x:g+20,y:e}),d.push({x:g+20,y:f+20}),d.push({x:h,y:f+20})))),d}function j(a){return"top"===a?0:"right"===a?1:"bottom"===a?2:3}function k(a,b){var c="operation"===a.entity.type?m(a.entity.attr("width"),a.entity.attr("height")):a.entity.attr("width");return"right"===b?a.cx()+c/2:"top"===b||"bottom"===b?a.cx():a.cx()-c/2}function l(a,b){var c="operation"===a.entity.type?m(a.entity.attr("width"),a.entity.attr("height")):a.entity.attr("height");return"right"===b?a.cy():"top"===b?a.cy()-c/2:"bottom"===b?a.cy()+c/2:a.cy()}function m(c,a){var b=Math.pow;return Math.sqrt(b(c,2)+b(a,2))}function n(a){return JSON.parse(JSON.stringify(a))}function o(){//clean up
//rendering
// needed to have no circular dependencies
t.entities.forEach(function(a){return a.remove()}),t.entities=[],t.lines.children().forEach(function(a){return a.remove()}),w=[],t.grid.x.forEach(function(a){return a.line.remove()}),t.grid.y.forEach(function(){return x.line.remove()}),t.grid={x:[],y:[]},v.forEach(function(a){return a.remove()}),v=[],u.labels||(u.labels=[]),u.labels=u.labels.map(function(a){return{id:a.id,value:a.value?a.value:"",x:a.x?a.x:0,y:a.y?a.y:0,color:a.color?a.color:"black"}}),u.configuration||(u.configuration={}),u.configuration.read_only=!!u.configuration.read_only&&u.configuration.read_only,u.configuration.line_color=u.configuration.line_color?u.configuration.line_color:"#000000",u.configuration.arrow_type=u.configuration.arrow_type?u.configuration.arrow_type:"default",u.configuration.grid_type=u.configuration.grid_type?u.configuration.grid_type:"dynamic",u.configuration.grid_x=u.configuration.grid_x&&0<u.configuration.grid_x.length?u.configuration.grid_x.map(function(a){return{value:a.value?a.value:0,width:a.width?a.width:1,color:a.color?a.color:"black"}}):[],u.configuration.grid_y=u.configuration.grid_y&&0<u.configuration.grid_y.length?u.configuration.grid_y.map(function(a){return{value:a.value?a.value:0,width:a.width?a.width:1,color:a.color?a.color:"black"}}):[],u.entities.map(function(a){a.type=a.type?a.type:"entity","operation"===a.type&&(a.height=a.width)}),b(),c(),u.entities.forEach(function(b){return a(t,b)}),w=n(u.lines),f(t,w)}function p(a,b){null!==z[a]&&z[a]!==void 0&&z[a].forEach(function(a){return a(b)})}function q(a){var b="";return a&&a.target&&a.target.parentElement&&(b=a.target.parentElement.id),b}function r(a){u=n(a),y?o():SVG.on(document,"DOMContentLoaded",function(){o(),y=!0})}function s(){return u}var t,u={entities:[]},v=[],w=[],y=!1,z={};return{initalize:function(a,b,c){SVG.on(document,"DOMContentLoaded",function(){//grid
t=SVG().addTo(a).size(b,c),t.gridGroup=t.group(),t.grid={x:[],y:[]},t.entities=[],t.lines=t.group(),t.labels=t.group()})},update:r,register:function(a,b){(null===z[a]||z[a]===void 0)&&(z[a]=[]),z[a].push(b)},get:s}}

//# sourceMappingURL=workflow-svg.esm.js.map